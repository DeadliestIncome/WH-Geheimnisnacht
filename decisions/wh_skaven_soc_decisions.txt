society_decisions = { # Society decisions are only evaluated by members of societies
	skaven_rank_up_decision = {
		only_playable = yes

		hide_in_decisions_list = yes # This is shown in the Society View

		potential = {
				society_rank < 4
				has_dlc = "Mystics"
				is_in_society = yes
				is_landed = yes
				OR = { #Players can always rank up (if they have the power)
					ai = no
					AND = {
						ai = yes
						society_can_rank_up = yes
					}
				}
			}

		allow = {
			#Rank requirements. IMPORTANT!!! If you change the requirements, the customizable loc keys "GetSocietyRankUpTooltip" 1, 2, 3, and 4 must be updated, as it displays these requirements.
			OR = {
					trait = council_warlord #auto-rise to the top
					AND = {
						society_rank == 1
						society_currency >= 750
					}
					AND = {
						society_rank == 2
						society_currency >= 1000
					}
					AND = {
						society_currency >= 13000 # rank 3
						trait = ambitious #to prevent common suicides
						NOT = { trait = craven }
				}
			}
		}

		effect = {
			#Rank up cost
			if = {
				limit = { society_rank == 1
				NOT = { trait = council_warlord }}
				change_society_currency = -750
			}
			if = {
				limit = { society_rank == 2
				NOT = { trait = council_warlord }}
				change_society_currency = -1000
			}
			if = {
				limit = {
				society_rank == 3
				NOT = { trait = council_warlord }}
				change_society_currency = -13000
			}

			#Perform rank up
			hidden_tooltip = {
				set_character_flag = has_sent_request_to_rank_up
				character_event = { id = MNM.13130 }

			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.2
				trait = content
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 100
				trait = council_warlord
			}
		}
	}
}


society_decisions = {

	skaven_acquire_breeder = {
		only_playable = yes

		potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society

			OR = {
				ai = no
				AND = {
					ai = yes
					higher_tier_than = BARON
					any_courtier = {
					trait = skaven_breeder
					NOT = { trait = infertile }
					NOT = { trait = incapable }
					count = 0
						}
					}
				}
			}

		allow = {
				has_society_currency_minor_trigger = yes
			}


		effect = {
			custom_tooltip = { text = skaven_acquire_breeder_tooltip }
			detract_society_currency_minor_effect = yes
			hidden_tooltip = {
							create_character = {
							random_traits = yes
							age = 16
							female = yes
							culture = FROM
							trait = creature_skaven
							trait = skaven_breeder	}
				}
			}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.01 #Slow down
			}
		}
	}


	skaven_get_bodyguards = {
		only_playable = yes

		potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society
			society_rank >= 2
			OR = {
				ai = no
				AND = {
					ai = yes
					higher_tier_than = BARON
					}
				}
		}

		allow = {
				has_society_currency_minor_trigger = yes
		}

		effect = {
		detract_society_currency_minor_effect = yes
			capital_scope = {
				ROOT = {
					spawn_unit = {
						owner = ROOT
						province = PREV
						home = PREV
						troops = {
							heavy_infantry = { 169 169 }
						}
						attrition = 0.2
						reinforces = yes
						disband_on_peace = no
						maintenance_multiplier = 0.5
					}
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.001 #Slow it down
			}
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 10
				war = yes
			}
			modifier = {
				factor = 0
				NOT = { wealth = 300 }
			}
		}
	}

	skaven_get_troops = {
		only_playable = yes

		is_high_prio = yes

		potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society
			society_rank >= 3
		}

		allow = {
			war = yes
			has_society_currency_major_trigger = yes
		}

		effect = {
			capital_scope = {
				ROOT = {
					spawn_unit = {
						owner = ROOT
						province = PREV
						home = PREV
						troops = {
							light_infantry = { 6500 6500 }
						}
						attrition = 1
						disband_on_peace = yes
						maintenance_multiplier = 0
						reinforces = no
					}
				}
			}
			detract_society_currency_major_effect = yes
			sound_effect = generic_click_01
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.02 #Slowdown
			}
		}
	}

	skaven_trade_warpstone = {
		only_playable = yes

		is_high_prio = yes

		potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society
			society_rank >= 3
		}

		allow = {
			has_society_currency_medium_trigger = yes
		}

		effect = {
			detract_society_currency_medium_effect = yes
			add_artifact = warpstone
			hidden_tooltip = {
				random = {
					chance = 1
					add_trait = addict
				}
			}

		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.02 #Slowdown
			}
			modifier = {
				factor = 25 #Slowdown
				trait = grey_seer
			}
			modifier = {
				factor = 25 #Slowdown
				trait = plaguelord
			}
		}
	}
}

targeted_decisions = {
		skaven_induct_underling = {
		from_potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society
			NOT = { trait = incapable }
			NOT = { trait = wounded }
			NOT = { trait = maimed }
			society_rank = {
				society = skaven_society
				rank = 2
			}
		}
		potential = {
			OR = {
				trait = warlock_engineer
				trait = master_moulder
				trait = plaguelord
				trait = eshin_assassin
				trait = elite_stormvermin
				trait = council_warlord
				trait = grey_seer
				trait = black_skaven
				trait = white_skaven
				}
			is_adult = yes
			NOT = { trait = incapable }
			NOT = { society_member_of = skaven_society }
			}
		allow = {
			NOT = { is_rival = FROM }
			FROM = {society_currency = -50 }
			NOT = { society_member_of = skaven_society }
			vassal_of = FROM
				}


		effect = {
			FROM = { change_society_currency = -50
					prestige = 50}
			join_society = skaven_society
		}

		ai_will_do = {
			factor = 1
			}
	}

	skaven_great_surfacing = {
		ai_target_filter = independent_rulers
		only_playable = yes

		from_potential = {
			is_ruler = yes
			higher_tier_than = DUKE
			independent = yes
			NOT = { has_character_modifier = started_great_surfacing }
			society_rank = {
				society = skaven_society
				rank = 4
			}

		}
		potential = {
			is_within_diplo_range = FROM
			independent = yes
			realm_size = 10
			NOT = { trait = creature_skaven }
			NOT = { religion_group = greenskin_gods_group }
			higher_tier_than = DUKE

		}

		allow = {
			any_realm_province = {
				NOR = { location = { region = world_albion }
						location = { region = world_ulthuan }
						location = { region = world_chaos_wastes }
						location = { region = world_nehekhara }
				}
			}
			FROM = { society_currency = 2500 }
			FROM = { war = no }
		}

		effect = {
			FROM = { change_society_currency = -2500
			add_character_modifier = {
					modifier = started_great_surfacing
					duration = 5000 }
			character_event = { id = MNM.13140 days = 1 }
			}
			character_event = { id = MNM.13141 days = 1 }
			opinion = {
				who = FROM
				modifier = skaven_invading_me
				months = 24
				}
		}

		ai_will_do = {
			factor = 50
		}
	}

	skaven_bully_competitor = {
		only_playable = yes

		from_potential = {
			has_dlc = "Mystics"
			society_member_of = skaven_society
			NOT = { trait = incapable }
			NOT = { trait = wounded }
			NOT = { trait = maimed }
			NOT = {
				society_rank = {
					society = skaven_society
					rank >= 3 #council of 13 "bullies" skaven by simply existing
				}
			}
		}
		potential = {
			OR = {
				FROM = { ai = no }
				ai = no
			}
			OR = {
				FROM = { ai = yes }
				is_within_diplo_range = FROM # AI only checks inside realm, so is by definition in range

			}
			OR = {
				FROM = { ai = no }
				AND = {
					FROM = { ai = yes }
					NOT = { opinion = { who = ROOT
										value = -50 } } # to limit AI spam
					}
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			society_rank = {
				society = skaven_society
				rank == 1 #of course you bully the weakest ones, manthing!
				}
			}
		allow = {
			FROM = { society_currency = 200 }
				}

		effect = {
			FROM = { change_society_currency = -100 }
			random_list = {
				40 = {
					modifier = {
						factor = 1.2
						FROM = { martial = 15 }
					}
					modifier = {
						factor = 1.2
						FROM = { intrigue = 15 }
					}
					modifier = {
						factor = 1.5
						FROM = { trait = strong }
					}
					modifier = {
						factor = 2
						FROM = { trait = grey_seer }
					}
					modifier = {
						factor = 2
						FROM = { trait = plaguelord }
					}
					hidden_effect = { character_event = { id = MNM.13132 days = 1 } #beaten up
							FROM = { character_event = { id = MNM.13131  days = 1 } } #won
					}
				}
				40 = {
					hidden_effect = { character_event = { id = MNM.13133 days = 1 }
					FROM = { character_event = { id = MNM.13133  days = 1 } } #draw
				} }
				20 = {
					modifier = {
						factor = 1.2
						martial = 15
					}
					modifier = {
						factor = 1.2
						intrigue = 15
					}
					modifier = {
						factor = 1.5
						trait = strong
					}
					modifier = {
						factor = 2
						trait = grey_seer
					}
					modifier = {
						factor = 2
						trait = plaguelord
					}
					hidden_effect = { character_event = { id = MNM.13132 days = 1 } #beaten up
											{ character_event = { id = MNM.13131  days = 1 } } #won
					}
				}
			}

		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.05 # slow down
			}
			modifier = {
				is_friend = FROM
				factor = 0
			}
		}
	}
}
